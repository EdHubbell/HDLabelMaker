<Window x:Class="HDLabelMaker.Views.PrinterSelectionDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Select Printer" 
        Height="450" Width="600"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Text="Select Printer" 
                   FontSize="20" FontWeight="Bold" Margin="0,0,0,10"/>

        <TextBlock Grid.Row="1" 
                   Text="Choose a printer from the list below. Star TSP printers are highlighted."
                   Foreground="Gray" Margin="0,0,0,10"/>

        <DataGrid Grid.Row="2" 
                  ItemsSource="{Binding Printers}" 
                  SelectedItem="{Binding SelectedPrinter}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  SelectionMode="Single"
                  GridLinesVisibility="Horizontal"
                  BorderBrush="#CCCCCC"
                  BorderThickness="1">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Printer Name" Binding="{Binding Name}" Width="*"/>
                <DataGridTextColumn Header="Port" Binding="{Binding PortName}" Width="100"/>
                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
            </DataGrid.Columns>
            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsStarTsp}" Value="True">
                            <Setter Property="Background" Value="#E8F5E9"/>
                            <Setter Property="FontWeight" Value="Bold"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>
        </DataGrid>

        <StackPanel Grid.Row="3" Orientation="Horizontal" Margin="0,10">
            <Button Content="Refresh List" Click="RefreshButton_Click" Width="100" Margin="0,0,10,0"/>
            <Button Content="Test Connection" Click="TestButton_Click" Width="120" Margin="0,0,10,0"/>
            <TextBlock Text="{Binding StatusMessage}" VerticalAlignment="Center" Foreground="Gray"/>
        </StackPanel>

        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="Cancel" Click="CancelButton_Click" Width="80" Margin="0,0,10,0"/>
            <Button Content="Select" Click="SelectButton_Click" Width="80" FontWeight="Bold"/>
        </StackPanel>
    </Grid>
</Window>
